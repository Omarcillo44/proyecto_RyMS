<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<ScrollPane fitToWidth="true" fitToHeight="true" pannable="true"
            xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="controller.MMsSimulacionController">

   <content>
      <VBox alignment="TOP_CENTER" spacing="20" VBox.vgrow="ALWAYS">
         <padding>
            <Insets top="30" right="30" bottom="30" left="30"/>
         </padding>

         <VBox spacing="20" maxWidth="1600" VBox.vgrow="ALWAYS">

            <HBox alignment="CENTER_LEFT" spacing="10">
               <Button fx:id="btnVolver" text="← Volver" onAction="#volver"/>
               <Label text="SISTEMA M/M/s - SIMULACIÓN" maxWidth="Infinity" HBox.hgrow="ALWAYS">
                  <font>
                     <Font name="System Bold" size="24"/>
                  </font>
               </Label>
            </HBox>

            <Separator/>

            <VBox spacing="10">
               <Label text="PARÁMETROS HEREDADOS (Analítico)"
                      style="-fx-font-weight: bold; -fx-font-size: 18px;"/>
               <HBox spacing="50">
                  <Label fx:id="lblLambdaHeredado" text="λ = -" style="-fx-font-size: 16px;"/>
                  <Label fx:id="lblMuHeredado" text="μ = -" style="-fx-font-size: 16px;"/>
                  <Label fx:id="lblSHeredado" text="s = -" style="-fx-font-size: 16px;"/>
               </HBox>
            </VBox>

            <Separator/>

            <VBox spacing="15">
               <Label text="PARÁMETROS DE SIMULACIÓN"
                      style="-fx-font-weight: bold; -fx-font-size: 18px;"/>

               <HBox spacing="10" alignment="CENTER_LEFT">
                  <Label text="N (Clientes a simular):" style="-fx-font-size: 14px;"/>
                  <TextField fx:id="txtN" prefWidth="150" promptText="Ej: 2000"/>
                  <Label text="(mínimo 100)" style="-fx-font-size: 12px; -fx-text-fill: gray;"/>
               </HBox>

               <HBox spacing="10" alignment="CENTER_LEFT">
                  <CheckBox fx:id="chkUsarSemilla" text="Usar semilla aleatoria:"
                            style="-fx-font-size: 14px;"/>
                  <TextField fx:id="txtSemilla" prefWidth="150" disable="true"
                             promptText="Ej: 12345"/>
               </HBox>

               <HBox spacing="15" alignment="CENTER_LEFT">
                  <Button fx:id="btnEjecutarSimulacion" text="Ejecutar Simulación"
                          prefWidth="200" prefHeight="40" onAction="#ejecutarSimulacion">
                     <font>
                        <Font name="System Bold" size="14"/>
                     </font>
                  </Button>
                  <ProgressBar fx:id="progressBar" prefWidth="300"
                               progress="0.0" visible="false"/>
                  <Label fx:id="lblProgreso" text="0%" visible="false"/>
               </HBox>
            </VBox>

            <Separator/>

            <VBox fx:id="vboxComparacion" spacing="15"
                  visible="false" VBox.vgrow="ALWAYS">
               <Label text="COMPARACIÓN: ANALÍTICO vs SIMULACIÓN"
                      style="-fx-font-weight: bold; -fx-font-size: 18px;"/>

               <TableView fx:id="tableComparacion" VBox.vgrow="ALWAYS">
                  <columnResizePolicy>
                     <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                  </columnResizePolicy>
                  <columns>
                     <TableColumn fx:id="colMetrica" text="Métrica"/>
                     <TableColumn fx:id="colTeorico" text="Teórico"/>
                     <TableColumn fx:id="colSimulado" text="Simulado"/>
                     <TableColumn fx:id="colError" text="Error %"/>
                  </columns>
               </TableView>
            </VBox>

            <VBox fx:id="vboxUtilizacion" spacing="12" visible="false">
               <Label text="UTILIZACIÓN POR SERVIDOR"
                      style="-fx-font-weight: bold; -fx-font-size: 18px;"/>

               <VBox fx:id="vboxUtilizacionServidores" spacing="8"/>

               <Label fx:id="lblUtilizacionPromedio"
                      text="• Utilización promedio: -"
                      style="-fx-font-weight: bold; -fx-font-size: 15px;"/>
               <Label fx:id="lblBalanceCarga"
                      text="• Balance de carga: -"
                      style="-fx-font-size: 15px;"/>
            </VBox>

            <VBox fx:id="vboxMetricasAdicionales" spacing="12" visible="false">
               <Label text="MÉTRICAS ADICIONALES"
                      style="-fx-font-weight: bold; -fx-font-size: 18px;"/>

               <Label fx:id="lblMaxCola" text="• Máxima longitud de cola: -"
                      style="-fx-font-size: 15px;"/>
               <Label fx:id="lblMaxEspera" text="• Tiempo máximo de espera: -"
                      style="-fx-font-size: 15px;"/>
               <Label fx:id="lblSinEspera" text="• Clientes sin espera: -"
                      style="-fx-font-size: 15px;"/>
               <Label fx:id="lblIC95" text="• IC 95% para Wq: -"
                      style="-fx-font-size: 15px;"/>
               <Label fx:id="lblLittle" text="• Validación Little: -"
                      wrapText="true" style="-fx-font-size: 15px;"/>

               <Button fx:id="btnVerTabla" text="Ver Tabla Detallada"
                       prefWidth="250" prefHeight="40"
                       onAction="#verTablaDetallada">
                  <font>
                     <Font size="14"/>
                  </font>
               </Button>
            </VBox>

         </VBox>
      </VBox>
   </content>
</ScrollPane>
